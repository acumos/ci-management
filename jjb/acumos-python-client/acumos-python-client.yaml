---
- project:
    name: acumos-python-client-project-view
    project-name: acumos-python-client
    views:
      - project-view

- acp_common: &acp_common
    name: acp-common
    # git repo
    project: acumos-python-client
    # jenkins job name prefix
    project-name: acumos-python-client
    # maven settings file has credentials
    mvn-settings: acumos-python-client-settings
    # release job requires centos
    build-node: centos7-avx-4c-4g

# committer management
- project:
    name: acumos-python-client-info
    <<: *acp_common
    jobs:
      - gerrit-info-yaml-verify

# verify distribution and publish to test.pypi.org
- project:
    name: acumos-python-client-pypi
    <<: *acp_common
    parallel: false
    jobs:
      - '{project-name}-gerrit-pypi-jobs'
    stream:
      - master:
          branch: master
      - boreas:
          branch: boreas

# promote distribution from test.pypi.org to pypi.org
- project:
    name: acumos-python-client-release
    <<: *acp_common
    jobs:
      - '{project-name}-gerrit-pypi-release-jobs'

# analyze unit test coverage
- project:
    name: acumos-python-client-sonar
    <<: *acp_common
    branch: master
    # runs maven plugin to push report
    mvn-goals: clean install
    mvn-opts: -Xmx1024m -XX:MaxPermSize=256m
    sonarcloud: true
    sonarcloud-project-organization: '{sonarcloud_project_organization}'
    sonarcloud-api-token: '{sonarcloud_api_token}'
    sonarcloud-project-key: '{sonarcloud_project_organization}_{project-name}'
    jobs:
      - gerrit-tox-sonar
